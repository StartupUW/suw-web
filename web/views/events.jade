extends layout

block css
    link(rel='stylesheet', href='/css/events.css')

block splash
  .title
    h1= title.toUpperCase()

  .subtitle
    p welcome to #{title.toLowerCase()}

mixin event(event)
  .pure-g
    .event
      .pure-u-1.pure-u-md-11-24
        .img
          img(src=event.cover, height='100%', width='100%')
      .pure-u-1.pure-u-md-13-24
        .name
          a(href='https://facebook.com/events/' + event.id).name=event.name
        .at
          i.fa.fa-clock-o
          span #{event.at}
        .location
          i.fa.fa-map-marker
          span=  event.place
        .description
          i.fa.fa-info
          span= event.desc

block content
  -var n = events.length
  if events
    #all-events.events
      each event in events
        +event(event)
  script.
    var numb= #{n} - 1
    console.log(document.getElementById("all-events").clientHeight);
    var num = document.getElementsByClassName("event")[0].clientHeight + document.getElementsByClassName("event")[1].clientHeight + document.getElementsByClassName("event")[2].clientHeight+document.getElementsByClassName("event")[3].clientHeight + document.getElementsByClassName("event")[4].clientHeight
    num = num+ 60*5;
    var i = 5;
    document.getElementById("all-events").style.height = num + "px"
    document.addEventListener('scroll', function (event) {
    if (document.body.scrollHeight == 
      document.body.scrollTop +        
      window.innerHeight &&  document.getElementById("all-events").clientHeight <= numb*(document.getElementsByClassName("event")[0].clientHeight + 50)) {
      num = document.getElementsByClassName("event")[i].clientHeight + document.getElementsByClassName("event")[i+1].clientHeight + document.getElementsByClassName("event")[i+2].clientHeight+document.getElementsByClassName("event")[i+3].clientHeight + document.getElementsByClassName("event")[i+4].clientHeight
      num = num*3 + 100*10;
      document.getElementById("all-events").style.height = document.getElementById("all-events").clientHeight + num + "px"
      i = i+5;
    }
    });


    
